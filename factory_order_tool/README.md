# 🏭 工厂订单转换工具 使用说明

## 🧭 工具用途

- 本工具用于将**客户采购单 PDF** 自动转换为**工厂系统可导入的 Excel 文件**。
- 核心功能是将客户的料件编号（例如 `YY60030058`）自动映射为工厂内部产品编号（例如 `J00010038`），从而省去人工逐条查找和填写的工作。

---

## ⚙️ 基本逻辑

> 客户采购单 PDF 📄 → 自动提取表格数据 🔍 → 按映射表转换编码 🔁 → 输出工厂系统 Excel 📊

### 1）📥 PDF 解析

程序自动读取客户采购单 PDF 中的每一行订单，提取以下字段：**料件编号、数量、单价、出货日期**等信息。

### 2）🔗 编码映射

根据映射表（`mapping_table.xlsx`），将客户料件编号**一对一转换**为工厂产品编号，并自动填入对应的**产品名称**和**工艺路线**。

### 3）📤 Excel 输出

按照工厂系统「**导入产品明细模板**」的 19 列格式生成 Excel，生成的文件可以直接导入工厂系统。

---

## 🪜 操作步骤

| 步骤 | 操作 | 说明 |
|:---:|------|------|
| **1** | 双击打开程序 | 运行 `订单转换工具.exe` |
| **2** | 点击 **「选择 PDF」** | 选择客户发来的采购单 PDF 文件 |
| **3** | 点击 **「解析并映射」** | 程序自动完成解析和编码转换 |
| **4** | 在预览表格中检查结果 | 🟢 绿色行 = 映射成功，编码已自动转换<br>🔴 红色行 = 未找到映射，需要在映射表中补充 |
| **5** | 点击 **「导出工厂 Excel」** | 确认无误后保存文件 |

---

## 🗂️ 映射表维护

映射表文件 `mapping_table.xlsx` 存放在程序同目录下，用于记录客户编号与工厂编号的对应关系。

### 维护方法

1. 📖 **查看/编辑映射表**
   - 点击程序中的 **「打开映射表 (Excel)」**，可直接用 Excel 编辑

2. ➕ **新增产品时**
   - 在映射表中添加一行
   - 填写客户的**产品规格编号**以及对应的**工厂产品编号**

3. 🔄 **编辑保存后**
   - 点击 **「重新加载映射表」** 即可生效，无需重启程序

---

## ⚠️ 注意事项

1. 📌 映射表**必须**与程序放在**同一文件夹**下，文件名必须为 `mapping_table.xlsx`
2. 🚨 如果出现**红色未映射行**，说明该产品为新品，或映射表中尚未录入，请先**补充映射表**然后**重新执行解析操作**
